<!DOCTYPE html>
<html>
<body style="margin: 0; overflow: hidden;">
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

    <button id="snap" style="position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 100; padding: 15px 30px; font-size: 18px; border-radius: 25px; background: #E4002B; color: white; border: 2px solid white;">
        ðŸ“¸ Take Photo
    </button>

    <a-scene embedded arjs renderer="logarithmicDepthBuffer: true; preserveDrawingBuffer: true;" vr-mode-ui="enabled: false">
        
        <a-marker preset="hiro">
            <a-image 
                src="characters.png" 
                position="0 5 0" 
                scale="18 10 1" 
                rotation="-90 0 0">
            </a-image>
        </a-marker>

        <a-entity camera></a-entity>
    </a-scene>

    <script>
        document.getElementById('snap').addEventListener('click', function () {
            // Grab the video (camera) and the AR scene (3D)
            let video = document.querySelector('video');
            let scene = document.querySelector('a-scene').canvas;
            
            // Combine them on a new canvas
            let canvas = document.createElement('canvas');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            let ctx = canvas.getContext('2d');
            
            // Draw real world, then draw characters on top
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
            ctx.drawImage(scene, 0, 0, canvas.width, canvas.height);
            
            // Trigger download
            let link = document.createElement('a');
            link.download = 'WebAR-Photo.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
        });
    </script>
</body>
</html>
